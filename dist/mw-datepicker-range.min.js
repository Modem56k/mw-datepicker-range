/**
 * @version 1.1.0
 * @license MIT
 * @Author MrWook
 */
!function(e){"use strict";var t=e.module("mw-datepicker-range",["ui.bootstrap.datepicker","ui.bootstrap.datepickerPopup"]);t.config(["$provide","$injector",function(t,r){var n=function(t){var r=t[0],n=r.link;return r.compile=function(){return function(t,r,a,i){if(n.apply(this,arguments),t.selected_dates=[],t.select_range,void 0===a.mwMultiSelect){var o=e.element(r.parent().parent().parent().parent().children()[0]).attr("mw-multi-select");void 0!==o&&t.$parent.$parent.$parent.$parent.$watchCollection(o,function(e){t.selected_dates=e||[]})}else{var o=a.mwMultiSelect;t.$parent.$watchCollection(o,function(e){t.selected_dates=e||[]})}if(void 0!==o){a.$observe("mwMultiSelectType",function(e){t.selected_type=!!e&&"false"!==e}),t.selected_type=!0;var l=i[1];l.$viewChangeListeners.push(function(){var e=t.$parent.$eval(a.ngModel);if(e||null===t.$parent.$parent.$parent||(e=t.$parent.$parent.$parent.date),e){var r=Math.round(+e.setHours(0,0,0,0)),n=t.selected_dates;if(t.selected_type){if(!n.length||n.length>1||n[0]==r)return n.splice(0,n.length,r);n.push(r);var i=new Date(Math.min.apply(null,n)),o=new Date(Math.max.apply(null,n));for(i=new Date(i.setDate(i.getDate()+1));o>i;)n.push(Math.round(+i.setHours(0,0,0,0))),i=new Date(i.setDate(i.getDate()+1))}}})}}},t};r.has("uibDatepickerDirective")&&t.decorator("uibDatepickerDirective",["$delegate",n]);var a=function(t,r,n){var a=t[0],i=a.link;return a.compile=function(){return function(t,a,o,l){function c(i){s=e.element(a.parent().children()[0]).attr("mw-multi-select");var l=o.uibDatepickerPopup||"dd.MM.y";n(function(){var e=t.$parent[s];void 0===e&&(e=[]);var n="",a="";e.length>0&&(n=r("date")(r("orderBy")(e)[0],l),e.length>1&&(a=" - "+r("date")(r("orderBy")(e,"-")[0],l))),u.$setViewValue(n+a),u.$render()},0)}i.apply(this,arguments);var u=l[0],s=e.element(a.parent().children()[0]).attr("mw-multi-select");if(void 0!==s){u.$viewChangeListeners=[function(){t.date=u.$modelValue}],u.$formatters=[function(e){c(e)}],u.$parsers=[function(e){c(e)}];var p=t.select;t.select=function(r,n){p(r,n);var i=e.element(a.parent().children()[0]).attr("mw-multi-select");null===r?t.$parent[i]=[]:"today"===r&&(t.$parent[i]=[(new Date).setHours(0,0,0,0)])}}}},t};r.has("uibDatepickerPopupDirective")&&t.decorator("uibDatepickerPopupDirective",["$delegate","$filter","$timeout",a])}]),t.directive("mwMultiSelect",["$compile",function(e){return{priority:1001,terminal:!0,compile:function(t,r){var n=r.mwMultiSelect,a=r.datepickerOptions;t.attr("close-on-date-selection",!1),t.attr("onkeypress","return false;"),t.attr("readonly","");var i=e(t,null,1001);return function(e){if(void 0===e[a]&&(e[a]={}),void 0!==e[a].customClass)var t=e[a].customClass;var r="";e[a].customClass=function(a){void 0!==t&&(r=t(a)),void 0===e[n]&&(e[n]=[]);var i=Math.round(+a.date.setHours(0,0,0,0));return e[n].indexOf(i)>-1||e[n].indexOf(i+36e5)>-1?r+" selected":""},i(e)}}}}]),t.service("mwMultiSelectService",["$filter",function(e){var t={};return t.parse=function(t,r){void 0===t&&(t=[]);var n={};return t.length>0&&(n.before=e("orderBy")(t)[0],void 0!==r&&(n.before=e("date")(n.before,r)),t.length>1&&(n.after=e("orderBy")(t,"-")[0],void 0!==r&&(n.after=e("date")(n.before,r)))),n},t}])}(window.angular);